  module rkg
! -----------------------------------------------------------------------------
!                    MODULE rkg
! -----------------------------------------------------------------------------
  use common
  implicit none
! === coefficient parameters for runge-kutta-gill scheme
  real(DP), dimension(0:NZ,-1:NY,-1:NX) :: qbx,  qby,  qbz  
  real(DP), dimension(0:NZ,-1:NY,-1:NX) :: qvx,  qvy,  qvz 
  real(DP), dimension(0:NZ,-1:NY,-1:NX) :: qro,  qpr,  qph 
  real(DP) :: c1, c2, c3, c4
  real(DP) :: cq1, cq2, cq3, cs2, cs3
  integer  :: i,j,k
  public
  contains
!
! =============================================================================
  subroutine rkg__set_coefficient
! =============================================================================
  c1  = 0.5d0
  c2  = 1.0d0 - sqrt(0.5d0)
  c3  = 1.0d0 + sqrt(0.5d0)
  c4  = 1.0d0 / 6.0d0
  cq1 = -2.0d0
  cq2 =  1.0d0 - 3.0d0 * c2
  cs2 =  2.0d0 * c2
  cq3 =  1.0d0 - 3.0d0 * c3
  cs3 =  2.0d0 * c3
!
  return
  end subroutine rkg__set_coefficient

! ============================================================================
  subroutine rkg__prog1
! ============================================================================
  ro(:,:,:) = ro(:,:,:) + c1 * dro(:,:,:)
  bx(:,:,:) = bx(:,:,:) + c1 * dbx(:,:,:)
  by(:,:,:) = by(:,:,:) + c1 * dby(:,:,:)
  bz(:,:,:) = bz(:,:,:) + c1 * dbz(:,:,:)
  vx(:,:,:) = vx(:,:,:) + c1 * dvx(:,:,:)
  vy(:,:,:) = vy(:,:,:) + c1 * dvy(:,:,:)
  vz(:,:,:) = vz(:,:,:) + c1 * dvz(:,:,:)
  pr(:,:,:) = pr(:,:,:) + c1 * dpr(:,:,:)
  ph(:,:,:) = ph(:,:,:) + c1 * dph(:,:,:)
!
  qro(:,:,:) = dro(:,:,:)
  qbx(:,:,:) = dbx(:,:,:)
  qby(:,:,:) = dby(:,:,:)
  qbz(:,:,:) = dbz(:,:,:)
  qvx(:,:,:) = dvx(:,:,:)
  qvy(:,:,:) = dvy(:,:,:)
  qvz(:,:,:) = dvz(:,:,:)
  qpr(:,:,:) = dpr(:,:,:)
  qph(:,:,:) = dph(:,:,:)
!
  return
  end subroutine rkg__prog1

! =============================================================================
  subroutine rkg__prog2
! =============================================================================
  ro(:,:,:) = ro(:,:,:) + c2 * ( dro(:,:,:) - qro(:,:,:) )
  bx(:,:,:) = bx(:,:,:) + c2 * ( dbx(:,:,:) - qbx(:,:,:) )
  by(:,:,:) = by(:,:,:) + c2 * ( dby(:,:,:) - qby(:,:,:) )
  bz(:,:,:) = bz(:,:,:) + c2 * ( dbz(:,:,:) - qbz(:,:,:) )
  vx(:,:,:) = vx(:,:,:) + c2 * ( dvx(:,:,:) - qvx(:,:,:) )
  vy(:,:,:) = vy(:,:,:) + c2 * ( dvy(:,:,:) - qvy(:,:,:) )
  vz(:,:,:) = vz(:,:,:) + c2 * ( dvz(:,:,:) - qvz(:,:,:) )
  pr(:,:,:) = pr(:,:,:) + c2 * ( dpr(:,:,:) - qpr(:,:,:) )
  ph(:,:,:) = ph(:,:,:) + c2 * ( dph(:,:,:) - qph(:,:,:) )
!
  qro(:,:,:) = cq2 * qro(:,:,:) + cs2 * dro(:,:,:)
  qbx(:,:,:) = cq2 * qbx(:,:,:) + cs2 * dbx(:,:,:)
  qby(:,:,:) = cq2 * qby(:,:,:) + cs2 * dby(:,:,:)
  qbz(:,:,:) = cq2 * qbz(:,:,:) + cs2 * dbz(:,:,:)
  qvx(:,:,:) = cq2 * qvx(:,:,:) + cs2 * dvx(:,:,:)
  qvy(:,:,:) = cq2 * qvy(:,:,:) + cs2 * dvy(:,:,:)
  qvz(:,:,:) = cq2 * qvz(:,:,:) + cs2 * dvz(:,:,:)
  qpr(:,:,:) = cq2 * qpr(:,:,:) + cs2 * dpr(:,:,:)
  qph(:,:,:) = cq2 * qph(:,:,:) + cs2 * dph(:,:,:)
!
  return
  end subroutine rkg__prog2

! =============================================================================
  subroutine rkg__prog3
! =============================================================================
  ro(:,:,:) = ro(:,:,:) + c3 * ( dro(:,:,:) - qro(:,:,:) )
  bx(:,:,:) = bx(:,:,:) + c3 * ( dbx(:,:,:) - qbx(:,:,:) )
  by(:,:,:) = by(:,:,:) + c3 * ( dby(:,:,:) - qby(:,:,:) )
  bz(:,:,:) = bz(:,:,:) + c3 * ( dbz(:,:,:) - qbz(:,:,:) )
  vx(:,:,:) = vx(:,:,:) + c3 * ( dvx(:,:,:) - qvx(:,:,:) )
  vy(:,:,:) = vy(:,:,:) + c3 * ( dvy(:,:,:) - qvy(:,:,:) )
  vz(:,:,:) = vz(:,:,:) + c3 * ( dvz(:,:,:) - qvz(:,:,:) )
  pr(:,:,:) = pr(:,:,:) + c3 * ( dpr(:,:,:) - qpr(:,:,:) )
  ph(:,:,:) = ph(:,:,:) + c3 * ( dph(:,:,:) - qph(:,:,:) )
!
  qro(:,:,:) = cq3 * qro(:,:,:) + cs3 * dro(:,:,:)
  qbx(:,:,:) = cq3 * qbx(:,:,:) + cs3 * dbx(:,:,:)
  qby(:,:,:) = cq3 * qby(:,:,:) + cs3 * dby(:,:,:)
  qbz(:,:,:) = cq3 * qbz(:,:,:) + cs3 * dbz(:,:,:)
  qvx(:,:,:) = cq3 * qvx(:,:,:) + cs3 * dvx(:,:,:)
  qvy(:,:,:) = cq3 * qvy(:,:,:) + cs3 * dvy(:,:,:)
  qvz(:,:,:) = cq3 * qvz(:,:,:) + cs3 * dvz(:,:,:)
  qpr(:,:,:) = cq3 * qpr(:,:,:) + cs3 * dpr(:,:,:)
  qph(:,:,:) = cq3 * qph(:,:,:) + cs3 * dph(:,:,:)
!
  return
  end subroutine rkg__prog3

! =============================================================================
  subroutine rkg__prog4
! =============================================================================
  ro(:,:,:) = ro(:,:,:) + c4 * ( dro(:,:,:) - 2. * qro(:,:,:) )
  bx(:,:,:) = bx(:,:,:) + c4 * ( dbx(:,:,:) - 2. * qbx(:,:,:) )
  by(:,:,:) = by(:,:,:) + c4 * ( dby(:,:,:) - 2. * qby(:,:,:) )
  bz(:,:,:) = bz(:,:,:) + c4 * ( dbz(:,:,:) - 2. * qbz(:,:,:) )
  vx(:,:,:) = vx(:,:,:) + c4 * ( dvx(:,:,:) - 2. * qvx(:,:,:) )
  vy(:,:,:) = vy(:,:,:) + c4 * ( dvy(:,:,:) - 2. * qvy(:,:,:) )
  vz(:,:,:) = vz(:,:,:) + c4 * ( dvz(:,:,:) - 2. * qvz(:,:,:) )
  pr(:,:,:) = pr(:,:,:) + c4 * ( dpr(:,:,:) - 2. * qpr(:,:,:) )
  ph(:,:,:) = ph(:,:,:) + c4 * ( dph(:,:,:) - 2. * qph(:,:,:) )
!
  return
  end subroutine rkg__prog4
  end module rkg
